{
    "contents" : "## =========================================================================================================================================== ##\n## In this project, we will investigate the exponential distribution in R and compare it with the Central Limit Theorem. \n## The exponential distribution can be simulated in R with rexp(n, lambda) where lambda is the rate parameter. \n## The mean of exponential distribution is 1/lambda and the standard deviation is also 1/lambda. \n## Set lambda = 0.2 for all of the simulations. \n## We will investigate the distribution of averages of 40 exponentials. \n## Note that we will need to do a thousand simulations.\n\n## Illustrate via simulation and associated explanatory text the properties of the distribution of the mean of 40 exponentials. \n## We should:\n##      - Show the sample mean and compare it to the theoretical mean of the distribution.\n##      - Show how variable the sample is (via variance) and compare it to the theoretical variance of the distribution.\n##      - Show that the distribution is approximately normal.\n## =========================================================================================================================================== ##\n\nlibrary(knitr)\nopts_chunk$set(fig.width=7, fig.height=4, warning=FALSE, message=FALSE)\n\n## Load necessary libraries\nlibrary(ggplot2)\n\n## Set constants\nlambda <- 0.2\nn <- 40 \nnosim <- 1000\n\n# Set the seed for reproducability\nset.seed(756)\n\n## Collect data\n\nexp_sim <- function(n, lambda)\n{\n        mean(rexp(n,lambda))\n}\n\n## Simulate data\n\nsim <- data.frame(ncol=2,nrow=1000)\nnames(sim) <- c(\"Index\",\"Mean\")\n\nfor (i in 1:nosim)\n{\n        sim[i,1] <- i\n        sim[i,2] <- exp_sim(n,lambda)\n}\n\n## Find Mean of n = 1000\n\nsample_mean <- mean(sim$Mean)\nsample_mean\n\n## Histogram of means\n\nexp_dis <- matrix(data=rexp(n * nosim, lambda), nrow=nosim)\nexp_dis_means <- data.frame(means=apply(exp_dis, 1, mean))\n\nggplot(data = exp_dis_means, aes(x = means)) + \n        geom_histogram(binwidth=0.1) +   \n        ggtitle(\"Hiistogram of Sample Means\") +\n        scale_x_continuous(breaks=round(seq(min(exp_dis_means$means), max(exp_dis_means$means), by=1)))\n\n## Theoretical exponential mean of exponential distribution\n\ntheor_mean <- 1/lambda\ntheor_mean\n\n## Histogram plot of the exponential distribution n = 1000\n\nhist(sim$Mean, \n     breaks=100, \n     prob=TRUE, \n     main=\"Exponential Distribution n = 1000\", \n     xlab=\"Spread\")\nabline(v = theor_mean, \n       col= 4,\n       lwd = 2)\nabline(v = sample_mean, \n       col = 2,\n       lwd = 2)\n\nlegend('topright', c(\"Sample Mean\", \"Theoretical Mean\"), \n       lty=c(1,1), \n       bty = \"n\",\n       col = c(col=2, col=4))\n\n## Variance\n\nsample_var <- var(sim$Mean)\ntheor_var <- ((1/lambda)^2)/40\n\n## Histogram of Theoretical Curve\n\nhist(sim$Mean, \n     breaks = 100, \n     prob = TRUE, \n     main =\"Exponential Distribution n = 1000\", \n     xlab =\"Spread\")\nxfit <- seq(min(sim$Mean), max(sim$Mean), length = 100)\nyfit <- dnorm(xfit, mean = 1/lambda, sd = (1/lambda/sqrt(40)))\nlines(xfit, yfit, pch=22, col=4, lty=2, lwd=2)\nlegend('topright', c(\"Theoretical Curve\"), bty=\"n\", lty=2,lwd=2, col=4)\n\n## Histogram of Simulated Exponential Distribution\n\nhist(sim$Mean, \n     breaks = 100, \n     prob = TRUE, \n     main = \"Distribution of Simulated Exponential Distribution\", xlab=\"\")\nlines(density(sim$Mean), col=3, lwd=2)\nabline(v = 1/lambda, col = 4, lwd=4)\nxfit <- seq(min(sim$Mean), max(sim$Mean), length = 100)\nyfit <- dnorm(xfit, mean = 1/lambda, sd = (1/lambda/sqrt(40)))\nlines(xfit, yfit, pch=22, col=4, lty=2, lwd=2)\nlegend('topright', c(\"Simulated Values\", \"Theoretical Values\"), bty=\"n\", lty=c(1,2), col=c(3,4))\n\n## Quantile of Normal Distribution\n\nqqnorm(sim$Mean, \n       main=\"Normal Q-Q Plot\")\nqqline(sim$Mean, \n       col=\"4\")",
    "created" : 1454202292516.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1149194579",
    "id" : "B2F2C64C",
    "lastKnownWriteTime" : 1454183969,
    "path" : "C:/Users/Anuar Imanbayev/Desktop/DataScienceCourse/DSC_Working_Directory/SI_Project/project1.R",
    "project_path" : "project1.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "type" : "r_source"
}